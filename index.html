<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Teszt</title>
  <script src="js/draughts.js"></script>
  <script src="js/draughtsboard.js"></script>
  <link href="css/draughtsboard.css" rel="stylesheet" />
</head>

<body>
  <p>
    Lorem ipsum dolor sit amet consectetur adipisicing elit. Dolor saepe impedit cum ipsum mollitia. Fugit voluptatem
    dolorum hic id nam quod. Nemo corporis quibusdam distinctio delectus amet ipsum corrupti neque?
    Lorem ipsum dolor sit amet consectetur adipisicing elit. Nobis, officiis neque repellat non expedita nostrum sint
    est repellendus molestiae commodi corrupti enim soluta itaque voluptates iusto, vitae ducimus molestias velit.
    Lorem ipsum dolor sit amet consectetur, adipisicing elit. Commodi similique aperiam sunt eos exercitationem nulla,
    inventore aut quos necessitatibus sed beatae voluptate vel officia quod aspernatur, consectetur facilis, porro
    nesciunt.
  </p>

  <br>
    Példa megoldás: <br>
    var solution = ["32-28", "2-8", "28-22", "8-12", "31-26", "1-6", "22-17", "12x21", "26x17"]
  </p>

  <div id="board" style="width: 500px"></div>
  <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  <script src="js/draughts.js"></script>
  <script src="js/draughtsboard.js"></script>
  <link rel="css/stylesheet" href="draughtsboard.css">

  <script>
    // Itt már nem XML-t olvasunk, hanem JS-ben állítjuk be a kezdő pozíciót (lásd előző példát):
    var fen = 'W:W31,32:B1,2'; // Ez a két fehér (31,32) és két fekete (1,2) bábu pozíciója
    var game = new Draughts(fen);

    function onDragStart(source, piece, position, orientation) {
      if (game.gameOver()) return false;
      var turn = game.turn();
      if ((turn === 'w' && piece[0] !== 'w') ||
        (turn === 'b' && piece[0] !== 'b'))
        return false;
    }


    //A lépés szintaktikája, objektuma: 
    // var Lépés = { jumps: [], takes: [], from: 31, to: 27, piecesTaken: undefined };

    var moveCount = 0; //A megoldás lépéseinek indexe

    function onDrop(source, target) {
      var legal = game.moves(); //Összes szabályos lépés

      var tryMove = legal[0]; //Így a fenti objektum típusú a tryMove
      tryMove.from = source;
      tryMove.to = target;

      //Példa jó megoldás
      //32-28, 2-8, 28-22, 8-12, 31-26, 1-6, 22-17, 12x21, 26x17, gameOver()
      var solution = ["32-28", "2-8", "28-22", "8-12", "31-26", "1-6", "22-17", "12x21", "26x17"];

      //Ennek ellenőrzése:
      if (moveCount == solution.length+1) { //Ha elfogyott az összes lépés a megoldásból
        game.gameOver();
      } else {
        var goodMove = solution[moveCount].split('-');  //A megoldás feldarabolás source-ra és target-re (ütésre még meg kell csinálni)
        if (source = goodMove[0] && target == goodMove[1]) { //Ha a lépés jó
          var move = game.move(tryMove); // Ha a lépés szabályos
          if (move === null) {
            return 'snapback';
          } else {
            console.log('Jó lépés');
            moveCount += 1;

            //Fekete automatikus válasz lépése (ütésre még meg kell csinálni)
            var blackMove = game.moves()[0];
            blackMove.from = solution[moveCount].split('-')[0];
            blackMove.to = solution[moveCount].split('-')[1];
            game.move(blackMove);
            moveCount += 1;
          }
        } else { //Ha a lépés nem a megoldás
          console.log('Nem jó megoldás');
          return 'snapback';
        }
      }

    }

    function onSnapEnd() {
      board.position(game.fen());
    }

    var config = {
      draggable: true,
      position: fen,
      onDragStart: onDragStart,
      onDrop: onDrop,
      onSnapEnd: onSnapEnd,
      pieceTheme: 'unicode'
    };
    var board = DraughtsBoard('board', config);
  </script>

  <p>
    Lorem, ipsum dolor sit amet consectetur adipisicing elit. Iure harum sunt adipisci, dolorum, voluptate nostrum
    repellendus quia iste deleniti, accusamus consequuntur illo? Esse neque alias ex laudantium quos fugit saepe?
    Lorem, ipsum dolor sit amet consectetur adipisicing elit. Perspiciatis repellat ad id, aspernatur unde consequatur
    veritatis ea adipisci rerum minima atque tempora recusandae. Harum autem molestias, quis dicta maiores error?
    Lorem ipsum dolor sit, amet consectetur adipisicing elit. Suscipit excepturi facere iusto dolorem fugit debitis,
    error accusamus eos aliquid qui id. Velit fuga accusamus laboriosam in quisquam aut nam sapiente!
  </p>



  <p>
    Lorem, ipsum dolor sit amet consectetur adipisicing elit. Iure harum sunt adipisci, dolorum, voluptate nostrum
    repellendus quia iste deleniti, accusamus consequuntur illo? Esse neque alias ex laudantium quos fugit saepe?
    Lorem, ipsum dolor sit amet consectetur adipisicing elit. Perspiciatis repellat ad id, aspernatur unde consequatur
    veritatis ea adipisci rerum minima atque tempora recusandae. Harum autem molestias, quis dicta maiores error?
    Lorem ipsum dolor sit, amet consectetur adipisicing elit. Suscipit excepturi facere iusto dolorem fugit debitis,
    error accusamus eos aliquid qui id. Velit fuga accusamus laboriosam in quisquam aut nam sapiente!
  </p>
</body>

</html>